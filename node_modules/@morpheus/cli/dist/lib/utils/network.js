"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.checkInternetConnectivity = void 0;
const dns = require("node:dns");
const url = require("node:url");
const errors_1 = require("../../errors");
function checkNetwork(_url) {
    return new Promise((resolve, reject) => {
        const parseUrl = url.parse(_url);
        if (parseUrl.hostname === null) {
            reject(new Error('baseUrl이 올바르지 않습니다.'));
            return;
        }
        dns.lookup(parseUrl.hostname, (err) => {
            if (err && err.code === 'ENOTFOUND') {
                reject(new errors_1.NetworkException(err.message || err));
            }
            else {
                resolve();
            }
        });
    });
}
function checkInternetConnectivity(cliConfig) {
    const templateUrl = cliConfig.template.mode === 'gitea' ? cliConfig.template.giteaBaseUrl : cliConfig.template.npmRegistryUrl;
    return Promise.all([checkNetwork(cliConfig.npmRegistryUrl), checkNetwork(templateUrl)]);
}
exports.checkInternetConnectivity = checkInternetConnectivity;
