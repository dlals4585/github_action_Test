"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getLatestRelease = exports.getTemplates = exports.createGiteaRequest = void 0;
const superagent_1 = require("./utils/superagent");
function createGiteaRequest(method, url, config) {
    return (0, superagent_1.createRequest)(method, `${config.template.giteaBaseUrl}${url}`, {
        userAgent: `node/superagent/Morpheus CLI ${config.package.version}`,
        disabledTLSCerts: config.disabledTLSCerts,
    });
}
exports.createGiteaRequest = createGiteaRequest;
async function getTemplates(config) {
    const searchParam = new URLSearchParams({ limit: '999' });
    const { req } = await createGiteaRequest('GET', `/orgs/${config.template.giteaTemplateOrg}/repos?${searchParam.toString()}`, config);
    const ret = await req;
    return ret.body;
}
exports.getTemplates = getTemplates;
async function getLatestRelease(templateName, config) {
    const { req } = await createGiteaRequest('GET', `/repos/${config.template.giteaTemplateOrg}/${templateName}/releases/latest`, config);
    const ret = await req;
    return ret.body;
}
exports.getLatestRelease = getLatestRelease;
